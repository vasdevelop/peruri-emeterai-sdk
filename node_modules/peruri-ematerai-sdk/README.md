# Introduction 
peruri-ematerai-sdk is an SDK to interact with smart contract regarding materai transaction 

# Getting Started
1. Create a file named “.npmrc” in the project’s folder and paste this code to that file: 
```
registry=https://pkgs.dev.azure.com/dattabot/Dattabot/_packaging/peruri-ematerai-sdk/npm/registry/  
 
always-auth=true 
; begin auth token 
//pkgs.dev.azure.com/dattabot/Dattabot/_packaging/peruri-ematerai-sdk/npm/registry/:username=dattabot 
//pkgs.dev.azure.com/dattabot/Dattabot/_packaging/peruri-ematerai-sdk/npm/registry/:_password=[BASE64_ENCODED_PERSONAL_ACCESS_TOKEN] 
//pkgs.dev.azure.com/dattabot/Dattabot/_packaging/peruri-ematerai-sdk/npm/registry/:email=npm requires email to be set but doesn't use the value 
//pkgs.dev.azure.com/dattabot/Dattabot/_packaging/peruri-ematerai-sdk/npm/:username=dattabot 
//pkgs.dev.azure.com/dattabot/Dattabot/_packaging/peruri-ematerai-sdk/npm/:_password=[BASE64_ENCODED_PERSONAL_ACCESS_TOKEN] 
//pkgs.dev.azure.com/dattabot/Dattabot/_packaging/peruri-ematerai-sdk/npm/:email=npm requires email to be set but doesn't use the value 
; end auth token
```
2. Change both of the "[BASE64_ENCODED_PERSONAL_ACCESS_TOKEN]" above with a token that will be provided later 
3. Install the SDK by running the command `npm i peruri-ematerai-sdk` in the project’s folder 
4. Create a new instance of the SDK. Here is the example: 
```
const SDK = require('peruri-ematerai-sdk’) 
const mySDK = new SDK(<YOUR_OWN_SEED>, <YOUR_OWN_URI>) 
```
5. Before using any method, add “TOKEN_SALT” to the environment variable: 
```
TOKEN_SALT = <YOUR_OWN_TOKENSALT> 
```
6. (Optional) There are two additional environment variables to be defined: 
```
ENS_ADDRESS = <YOUR_OWN_ENSADDRESS> 
RPC = <YOUR_OWN_RPC> 
```
Default value for each of these variables (if not defined) is: 
```
ENS_ADDRESS = ‘0xD712CF6D5ADd6ddee0F3CEfF9FEde7c7CB4e8412’ 
RPC = ‘https://net.haratoken.app’ 
```
# Available Methods
- getAddress 
- getMateraiBalance 
- transferMaterai 
- mintMaterai 
- useMaterai
- updateDocHash
- getDetailIssuedId
- getVerifyDocument
- newOrder
- confirmOrder
- cancelOrder
- releaseOrder
- getOrderDetail
- getHoldMaterai
- getSoldMaterai
- signMessage
- getHartBalance
- transferHart
- getStatusTXHash

# Methods Explanation

## getAddress(seed)

### What is This Method for? 
This method is used to get/know one’s own ethereum address based on  <YOUR_OWN_SEED> and the environment variable TOKEN_SALT. 
### Example of How to Use This Method
```let seed = <SOME STRING FOR YOUR SEED> ```

```let seed = "YourSeed" ```

```let myEthereumAddress = await mySDK.getAddress(seed) ```
### Input
- seed = some string for your address (string)

### Output 
- 0xsOmE123RaNdOm456StRiNg789HeRe 
- Data type: string 

## getMateraiBalance(address)

### What is This Method for? 
This method is used to get/know how much materai currently owned. 
### Example of How to Use This Method
```let address = <STRING OF ETHEREUM ADDRESS> ```

```let address = "0xbc2F805C6A6F4DccCD4CE72384cafe54B57E6790" ```

```let myMateraiBalance = await mySDK.getMateraiBalance(address)   ```
### Input
- address: the ethereum address (string) 

### Output 
- 100 
- Data type: number 

## transferMaterai(seed, to, amount)

### What is This Method for? 
This method is used to transfer the materai ownership. This method returns a hashed transaction receipt. 
### Example of How to Use This Method
```let seed = <SOME STRING FOR YOUR SEED> ```

```let seed = "YourSeed" ```

```let transferTxHash = await mySDK.transferMaterai(seed, <SOMEONE’S_ETHEREUM_ADDRESS>, 99999)  ```
### Input
- seed = some string for your address (string)
- to: the ethereum address of the transfer target (string) 
- amount: the amount of materai to transfer (number) 

### Output 
- txHash : 0xsOmE12LoNgEr34RaNdOm56StRiNg78HeRe90 (string)
- status : true/false (boolean)

## mintMaterai(seed, to, amount)

### What is This Method for? 
This method is used by PERURI or SUPER_ADMIN to generate certain amount of materai to a distributor account. This method returns a hashed transaction receipt. 
### Example of How to Use This Method
```let seed = <SOME STRING FOR YOUR SEED> ```

```let seed = "YourSeed" ```

```let mintTxHash = await mySDK.mintMaterai(seed, <SOMEONE’S_ETHEREUM_ADDRESS>, 99999)  ```
### Input
- seed = some string for your address (string)
- to: the ethereum address of the transfer target (string) 
- amount: the amount of materai to transfer (number)

### Output 
- txHash : 0xsOmE12LoNgEr34RaNdOm56StRiNg78HeRe90 (string)
- status : true/false (boolean)

## useMaterai(seed, listObjDoc, orgName, useOrgBalance)

### What is This Method for? 
This method is used when a materai is used, automatically reduce the materai balance by one. This method returns a hashed transaction receipt. 
### Params information
- seed = user ID, string type
- listObjDoc = materai information
- orgName = organization name if user are enrolled to some organizationa and want to use organization credit instead (if allowed). if you want to use your own credit, leave this blank
- useOrgBalance = boolean type. if you want to use organization balance. set to true and make sure that orgName is valid. if not then set to false
### Example of How to Use This Method
### For issue materai for 1 document or single use materai
```let seed = <SOME STRING FOR YOUR SEED> ```

```let seed = "YourSeed" ```

    let listObjDoc = [{docHash: '0x7465737400000000000000000000000000000000000000000000000000000000',docSign: '0x1234567800000000000000000000000000000000000000000000000000000000',materaiType: 10000}]

```let result = await mySDK.useMaterai(seed, listObjDoc)```
### Input
description of the input:
- docHash: hash from document (string of bytes32)
- docSign: sign hash from user (string of bytes32)
- materaitype: type of materai for use (number)

### Output 
    Output Object: {listTxHash: [{txHash: '0x310c1db44bd67a7762d2da66d3e3d9383ce593886f454d7f63d49e5aac3cf341', status: true}],listIssuedId: ['0xfff830f9ef16adf12b54027701c7092fac7d0401fef558bdf7e38e2ad2a284d7'],tokenUsed: 1}  

description of the output object:
- listTxHash = list of object tx hash and status (string and boolean)
- listIssuedId = list of issuedId (string)
- tokenUsed = token has been used for materai (number)
    
### For issue materai for multiple document or bulk use materai
```let seed = <SOME STRING FOR YOUR SEED> ```

```let seed = "YourSeed" ```

    let listObjDoc =[{docHash: '0x7465737400000000000000000000000000000000000000000000000000000000',docSign: '0x1234567800000000000000000000000000000000000000000000000000000000',materaiType: 10000},{docHash: '0x7465737400000000000000000000000000000000000000000000000000000000',docSign: '0x1234567800000000000000000000000000000000000000000000000000000000',materaiType: 10000}]

```let result = await mySDK.useMaterai(seed, listObjDoc)```
### Input
description of the input:
- docHash: hash from document (bytes32)
- docSign: sign hash from user (bytes32)
- materaitype: type of materai for use (number)

### Output 
    Output Object: {listTxHash: [{txHash: '0x310c1db44bd67a7762d2da66d3e3d9383ce593886f454d7f63d49e5aac3cf341', status: true},{txHash: '0x310c1db44bd67a7762d2da66d3e3d9383ce593886f454d7f63d49e5aac3cf341', status: true}],listIssuedId: ['0x1be30e59fd41d078c888f3eb1c0f59b2101687f8837275a85dc1dbdbe7e969f2','0x6c546e5579279e90680de9dbc6ef33c0bd3827c6828570a1dc87e2cd0aba3342'],tokenUsed: 2}

description of the output object:
- listTxHash = list of object tx hash and status (string and boolean)
- listIssuedId = list of issuedId (array of string)
- tokenUsed = token has been used for materai (number)

## updateDocHash(seed, listObjDoc)
### What is This Method for?
This method is use for update the document hash after document file combine with issued Id from method use materai
### Example of How to Use This Method
### For update 1 document hash
```let seed = <SOME STRING FOR YOUR SEED> ```

```let seed = "YourSeed" ```

    let listObjDoc = [{issuedId: '0xb78bc43e23c99c86bc72359d390f399aea7adcbabf371886494116f8bd7e727e',docHashAfter: '0x9999999900000000000000000000000000000000000000000000000000000000'}]

```let result = await mySDK.updateDocHash(seed, listObjDoc)```
### Input
description of the input:
- issuedId: issued id from the result use materai (bytes32)
- docHashAfter: docHash after combine document and issued id(bytes32)

### Output
    Array of object tx hash and status (string and boolean):[{txHash: '0x310c1db44bd67a7762d2da66d3e3d9383ce593886f454d7f63d49e5aac3cf341', status: true}]

### For update multiple document hash
```let seed = <SOME STRING FOR YOUR SEED> ```

```let seed = "YourSeed" ```

    let listObjDoc = [{issuedId: '0xb78bc43e23c99c86bc72359d390f399aea7adcbabf371886494116f8bd7e727e',docHashAfter: '0x9999999900000000000000000000000000000000000000000000000000000000'},{issuedId: '0x79a0513ee5e18becd72a62f27c6b9a66c1b28d1a38913dad6968117f60fcf83d',docHashAfter: '0x9999999900000000000000000000000000000000000000000000000000000000'}]

```let result = await mySDK.updateDocHash(seed, listObjDoc)```
### Input
description of the input:
- issuedId: issued id from the result use materai (bytes32)
- docHashAfter: docHash after combine document and issued id(bytes32)

### Output
    Array of object tx hash and status (string and boolean):[{txHash: '0x310c1db44bd67a7762d2da66d3e3d9383ce593886f454d7f63d49e5aac3cf341', status: true},{txHash: '0x310c1db44bd67a7762d2da66d3e3d9383ce593886f454d7f63d49e5aac3cf341', status: true}]
    
## getDetailIssuedId(issuedId)
### What is This Method for?
Get the detail information from a issued Id
### Example of How to Use This Method
```let issuedId = "0x4f40f5816499f6afb198c14249a69202479c433d5c2b2cb5913c0b893d2b8ff0";```

```let result = await mySDK.getDetailIssuedId(issuedId);```

### Output
    Output Object: {issuer: '0xbc2F805C6A6F4DccCD4CE72384cafe54B57E6790',docHashBefore: '0x7465737400000000000000000000000000000000000000000000000000000000',docHashAfter: '0x9999999900000000000000000000000000000000000000000000000000000000',docSign: '0x1234567800000000000000000000000000000000000000000000000000000000',timestamp: 5817853}
    
description of the output object:
- issuer = addres of issuer (string)
- docHashBefore = document hash before issue stamp duty (string)
- docHashAfter = document hash after issue stamp duty (string)
- docSign = sign for document from issuer (string)
- timestamp = unix time issue id (number)

## getVerifyDocument(issuedId, docHash)
### What is This Method for?
For verify the correctness of the document, based on the issued id and document hash
### Example of How to Use This Method
```let issuedId ="0x4f40f5816499f6afb198c14249a69202479c433d5c2b2cb5913c0b893d2b8ff0"```

```let docHash ="0x7465737400000000000000000000000000000000000000000000000000000000"```

```let result = await mySDK.getVerifyDocument(issuedId, docHash);```
### Output
- Boolean = true/false


## newOrder(seed, id, seller, amount, expired)
### What is This Method for?
This method for create new order from buyer to seller and propose some amount of materai token
### Example of How to Use This Method
```let seed = <your seed (string)>```

```let id = <transaction id from your system (string)>```

```let seller = <address of seller materai token (string of address)>```

```let amount = <amount of materai (number)>```

```let seed = <expired time of this order (number of unix timestamp)>```

``` let result = await mySDK.newOrder(seed, id, seller, amount, expired)```
### Output
- txHash : 0xsOmE12LoNgEr34RaNdOm56StRiNg78HeRe90 (string)
- status : true/false (boolean)

## confirmOrder(seed, id)
### What is This Method for?
This method is for confirmation a order from buyer and will transfer amount of token in order request from seller to buyer
### Example of How to Use This Method
```let seed = <your seed (string)>```

```let id = <transaction id from your system (string)>```

```let result = await mySDK.confirmOrder(seed, id)```

### Output
- txHash : 0xsOmE12LoNgEr34RaNdOm56StRiNg78HeRe90 (string)
- status : true/false (boolean)

## cancelOrder(seed, id)
### What is This Method for?
This method is for cancelation order from buyer and make status order become unhold done
### Example of How to Use This Method
```let seed = <your seed (string)>```

```let id = <transaction id from your system (string)>```

```let result = await mySDK.cancelOrder(seed, id)```
### Output
- txHash : 0xsOmE12LoNgEr34RaNdOm56StRiNg78HeRe90 (string)
- status : true/false (boolean)

## releaseOrder(seed, id)
### What is This Method for?
This method is for realease order from seller and make status order become realease
### Example of How to Use This Method
```let seed = <your seed (string)>```

```let id = <transaction id from your system (string)>```

```let result = await mySDK.releaseOrder(seed, id)```
### Output
- txHash : 0xsOmE12LoNgEr34RaNdOm56StRiNg78HeRe90 (string)
- status : true/false (boolean)

## getOrderDetail(id)
### What is This Method for?
This method is for get details information from a order
### Example of How to Use This Method
```let id = <transaction id from your system (string)>```

```let result = await mySDK.getOrderDetail(id)```

### Output
- from: address of seller (string of ethereum address)
- to: address of buyer (string of ethereum address)
- qty: amount of materai token (number)
- status: status of order (number)
- expTime: expire in unix format (number)

## getHoldMaterai(address)
### What is This Method for?
This method is for get information amount of hold materai token from an address
## Example of How to Use This Method
```let address = <STRING OF ETHEREUM ADDRESS> ```

```let address = "0xbc2F805C6A6F4DccCD4CE72384cafe54B57E6790" ```

```let myHoldMaterai = await mySDK.getHoldMaterai(address)```
### Input
- address: the ethereum address (string) 

### Output 
- 100 
- Data type: number

## getSoldMaterai(address, time)
### What is This Method for?
This method is for get information amount of sold materai token from an address in a time of sold
### Example of How to Use This Method
```let address = <STRING OF ETHEREUM ADDRESS> ```

```let address = "0xbc2F805C6A6F4DccCD4CE72384cafe54B57E6790" ```

```let time = <Unix Time>```

```let mySoldMaterai = await mySDK.getSoldMaterai(address, time)```

### Output 
- 100 
- Data type: number

## signMessage(seed, message)
### What is This Method for?
This method is for make some sign string from user account/wallet and message
### Example of How to Use This Method
```let seed = <your seed (string)>```

```let message = <your message (string)>```

```let signString= await mySDK.signMessage(seed, message)```

### Output
- string of sign message

## getHartBalance(address)
### What is This Method for?
## Example of How to Use This Method

```let address = <STRING OF ETHEREUM ADDRESS> ```

```let address = "0xbc2F805C6A6F4DccCD4CE72384cafe54B57E6790" ```

```let myHartBalance = await mySDK.getHartBalance(address)```
### Input
- address: the ethereum address (string) 

### Output 
- 100 
- Data type: number

## transferHart(seed, to, amount)
### What is This Method for?
This method for transfer hara token to another address
### Example of How to Use This Method

```let seed = <SOME STRING FOR YOUR SEED> ```

```let seed = "YourSeed" ```

```let transferTxHash = await mySDK.transferHart(seed, <SOMEONE’S_ETHEREUM_ADDRESS>, 99999)  ```
### Input
- seed = some string for your address (string)
- to: the ethereum address of the transfer target (string) 
- amount: the amount of materai to transfer (number) 

### Output 
- txHash : 0xsOmE12LoNgEr34RaNdOm56StRiNg78HeRe90 (string)
- status : true/false (boolean)

## getStatusTXHash(txHash)
### What is This Method for?
This method use for check the status of transaction on blockchain
### Example of How to Use This Method
```let txHash = "0xsOmE12LoNgEr34RaNdOm56StRiNg78HeRe90"```

```let status = await mySDK.getStatusTXHash(txHash)```
### Output
- true/false (boolean)

# Errors Explanation
## Error: Transaction has been reverted by the EVM
This error means that either 
- your address hasn’t been approved yet
- you are not authorized to use this method
- your materai balance is insufficient to use this method
 
If this error still persist, please contact us

## Error: Invalid Address
This error may appear in ```transferMaterai(to, amount)``` and ```mintMaterai(to, amount)``` when you provide an invalid address target (the “to” argument). There are a few cause for this. Either 
- your address target hasn’t been approved yet 
- misspelling 

Please check again the address spelling before contacting us.  